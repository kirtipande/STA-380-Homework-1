Author Attribution
================
Kirti Pande
August 19, 2018

Author Attribution
------------------

In the C50train directory, you have ~50 articles from each of 50 different authors (one author per directory). Use this training data (and this data alone) to build the two models. Then apply your model to the articles by the same authors in the C50test directory, which is about the same size as the training set. How well do your models do at predicting the author identities in this out-of-sample setting? Are there any sets of authors whose articles seem difficult to distinguish from one another? Which model do you prefer?

#### Loading necessary libraries

``` r
library(tm) 
```

    ## Loading required package: NLP

``` r
library(magrittr)
library(slam)
library(proxy)
```

    ## 
    ## Attaching package: 'proxy'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     as.dist, dist

    ## The following object is masked from 'package:base':
    ## 
    ##     as.matrix

#### Reading Train and Test data from the files

``` r
readerPlain = function(fname){
  readPlain(elem=list(content=readLines(fname)), 
            id=fname, language='en') 
}

train_list = Sys.glob('C:/Users/kirti/Downloads/MSBA/Introduction to Predictive modelling/Jame Scott assignment/STA380-master/STA380-master/data/ReutersC50/C50train/*/*.txt')
train = lapply(train_list, readerPlain) 

test_list = Sys.glob('C:/Users/kirti/Downloads/MSBA/Introduction to Predictive modelling/Jame Scott assignment/STA380-master/STA380-master/data/ReutersC50/C50test/*/*.txt')
test = lapply(test_list, readerPlain) 

mynames = train_list %>%
{ strsplit(., '/', fixed=TRUE) } %>%
{ lapply(., tail, n=2) } %>%
{ lapply(., paste0, collapse = '') } %>%
  unlist

mynamestest = test_list %>%
{ strsplit(., '/', fixed=TRUE) } %>%
{ lapply(., tail, n=2) } %>%
{ lapply(., paste0, collapse = '') } %>%
  unlist

names(train) = mynames
names(test) = mynamestest
```

#### Extracting the Author names for Train and Test data

``` r
authors = train_list %>%
{ strsplit(., '/', fixed=TRUE) } %>%
{ lapply(., function(x) x[13]) } %>%
{ lapply(., paste0, collapse = '') } %>%
  unlist

authors_test = test_list %>%
{ strsplit(., '/', fixed=TRUE) } %>%
{ lapply(., function(x) x[13]) } %>%
{ lapply(., paste0, collapse = '') } %>%
  unlist
```

#### Generating the Corpus for train and test data

``` r
documents_raw = Corpus(VectorSource(train))
documents_raw_test = Corpus(VectorSource(test))
```

#### Tokenization

``` r
my_documents = documents_raw
my_documents = tm_map(my_documents, content_transformer(tolower)) # make everything lowercase
my_documents = tm_map(my_documents, content_transformer(removeNumbers)) # remove numbers
my_documents = tm_map(my_documents, content_transformer(removePunctuation)) # remove punctuation
my_documents = tm_map(my_documents, content_transformer(stripWhitespace)) ## remove excess white-space

my_documents_test = documents_raw_test
my_documents_test = tm_map(my_documents_test, content_transformer(tolower)) # make everything lowercase
my_documents_test = tm_map(my_documents_test, content_transformer(removeNumbers)) # remove numbers
my_documents_test = tm_map(my_documents_test, content_transformer(removePunctuation)) # remove punctuation
my_documents_test = tm_map(my_documents_test, content_transformer(stripWhitespace)) ## remove excess white-space
```

#### Removing Stopwords

``` r
my_documents = tm_map(my_documents, content_transformer(removeWords), stopwords("en"))
my_documents_test = tm_map(my_documents_test, content_transformer(removeWords), stopwords("en"))
```

#### Creating Doc-term-matrix

Here we have created 2 set of train and test datasets The first set will involve dropping the uncommon words between the train and test dataset The second will involve including to test matrix the terms not present in test but in train as a dummy column with 0 assigned as the value

``` r
DTM_train = DocumentTermMatrix(my_documents)
DTM_test = DocumentTermMatrix(my_documents_test)

#Removing Sparse terms 
DTM_train = removeSparseTerms(DTM_train, 0.95)
DTM_test = removeSparseTerms(DTM_test, 0.95)

#Not removing Sparse terms in case of the second train-test set
DTM_train2 = DTM_train
DTM_test2 <- DocumentTermMatrix(my_documents_test, control = list(dictionary=Terms(DTM_train2)))
```

#### Constructing TF-IDF weights for both the above sets discussed

``` r
tfidf_train = weightTfIdf(DTM_train)
tfidf_test = weightTfIdf(DTM_test)

tfidf_test2 = weightTfIdf(DTM_test2)
tfidf_train2 = weightTfIdf(DTM_train2)
```

#### Dimensionlity Reduction: Principal Component Analysis

``` r
X = as.matrix(tfidf_train)
X_test = as.matrix(tfidf_test)

X2 = as.matrix(tfidf_train2)
X_test2 = as.matrix(tfidf_test2)

#Removing columns with entries with 0 values
scrub_cols = which(colSums(X) == 0)
scrub_cols_test = which(colSums(X_test) == 0)

scrub_cols2 = which(colSums(X2) == 0)
scrub_cols_test2 = which(colSums(X_test2) == 0)

X = X[,-scrub_cols]
X_test = X_test[,-scrub_cols_test]

X2 = X2[,-scrub_cols]
X_test2 = X_test2[,-scrub_cols_test2]
```

##### For the first set dropping the uncommon words

``` r
X_test <- X_test[,intersect(colnames(X_test),colnames(X))]
X <- X[,intersect(colnames(X_test),colnames(X))]
```

##### Running PCA for the train sets and predicting the PCs for the test set

``` r
pca_train = prcomp(X, scale=TRUE)
pca_test=predict(pca_train,newdata = X_test )

pca_train2 = prcomp(X2,scale=TRUE)
pca_test2=predict(pca_train2,newdata = X_test2 )
```

Choosing number of PCs to be selected

``` r
plot(pca_train,type='line')
```

![](tf_idf_md_files/figure-markdown_github/unnamed-chunk-12-1.png)

``` r
#summary(pca_train)

vars <- apply(pca_train$x, 2, var)  
props <- vars / sum(vars)
cumsum(props)
```

    ##        PC1        PC2        PC3        PC4        PC5        PC6 
    ## 0.01884331 0.03143255 0.04126696 0.05040137 0.05903120 0.06722648 
    ##        PC7        PC8        PC9       PC10       PC11       PC12 
    ## 0.07429256 0.08109714 0.08773668 0.09400921 0.09995867 0.10571440 
    ##       PC13       PC14       PC15       PC16       PC17       PC18 
    ## 0.11118341 0.11636058 0.12142937 0.12607878 0.13065307 0.13514838 
    ##       PC19       PC20       PC21       PC22       PC23       PC24 
    ## 0.13958562 0.14394544 0.14825645 0.15249590 0.15666027 0.16075540 
    ##       PC25       PC26       PC27       PC28       PC29       PC30 
    ## 0.16476270 0.16873097 0.17264176 0.17643770 0.18018152 0.18391308 
    ##       PC31       PC32       PC33       PC34       PC35       PC36 
    ## 0.18760432 0.19123456 0.19483149 0.19841445 0.20189804 0.20533855 
    ##       PC37       PC38       PC39       PC40       PC41       PC42 
    ## 0.20874739 0.21213424 0.21550050 0.21885581 0.22218239 0.22548965 
    ##       PC43       PC44       PC45       PC46       PC47       PC48 
    ## 0.22876216 0.23201309 0.23522814 0.23843654 0.24161140 0.24475006 
    ##       PC49       PC50       PC51       PC52       PC53       PC54 
    ## 0.24787882 0.25098015 0.25407634 0.25716078 0.26022973 0.26327942 
    ##       PC55       PC56       PC57       PC58       PC59       PC60 
    ## 0.26628982 0.26928819 0.27227267 0.27523911 0.27817377 0.28110506 
    ##       PC61       PC62       PC63       PC64       PC65       PC66 
    ## 0.28401753 0.28690714 0.28978359 0.29264875 0.29549567 0.29833211 
    ##       PC67       PC68       PC69       PC70       PC71       PC72 
    ## 0.30114151 0.30393540 0.30671959 0.30948503 0.31224346 0.31499728 
    ##       PC73       PC74       PC75       PC76       PC77       PC78 
    ## 0.31773484 0.32046180 0.32317504 0.32586275 0.32853653 0.33119212 
    ##       PC79       PC80       PC81       PC82       PC83       PC84 
    ## 0.33384452 0.33649575 0.33912219 0.34173596 0.34434319 0.34694612 
    ##       PC85       PC86       PC87       PC88       PC89       PC90 
    ## 0.34954501 0.35212071 0.35467098 0.35721806 0.35975822 0.36229022 
    ##       PC91       PC92       PC93       PC94       PC95       PC96 
    ## 0.36480999 0.36731190 0.36981018 0.37229209 0.37474929 0.37720183 
    ##       PC97       PC98       PC99      PC100      PC101      PC102 
    ## 0.37964553 0.38208068 0.38451366 0.38693842 0.38934153 0.39173346 
    ##      PC103      PC104      PC105      PC106      PC107      PC108 
    ## 0.39411632 0.39649017 0.39885794 0.40121744 0.40356069 0.40589263 
    ##      PC109      PC110      PC111      PC112      PC113      PC114 
    ## 0.40821972 0.41053621 0.41284482 0.41514559 0.41743799 0.41972029 
    ##      PC115      PC116      PC117      PC118      PC119      PC120 
    ## 0.42199716 0.42426391 0.42652475 0.42877282 0.43101266 0.43324375 
    ##      PC121      PC122      PC123      PC124      PC125      PC126 
    ## 0.43546738 0.43768567 0.43990157 0.44211066 0.44430072 0.44648262 
    ##      PC127      PC128      PC129      PC130      PC131      PC132 
    ## 0.44865810 0.45082737 0.45299001 0.45514586 0.45729327 0.45942546 
    ##      PC133      PC134      PC135      PC136      PC137      PC138 
    ## 0.46155648 0.46368109 0.46579556 0.46790658 0.47000210 0.47208117 
    ##      PC139      PC140      PC141      PC142      PC143      PC144 
    ## 0.47414992 0.47621199 0.47827201 0.48032516 0.48236804 0.48440952 
    ##      PC145      PC146      PC147      PC148      PC149      PC150 
    ## 0.48644419 0.48847244 0.49049509 0.49250851 0.49451693 0.49651890 
    ##      PC151      PC152      PC153      PC154      PC155      PC156 
    ## 0.49850884 0.50049671 0.50247542 0.50444742 0.50640991 0.50836657 
    ##      PC157      PC158      PC159      PC160      PC161      PC162 
    ## 0.51031488 0.51225723 0.51419483 0.51612279 0.51804826 0.51996922 
    ##      PC163      PC164      PC165      PC166      PC167      PC168 
    ## 0.52188444 0.52379629 0.52569347 0.52758526 0.52947263 0.53135385 
    ##      PC169      PC170      PC171      PC172      PC173      PC174 
    ## 0.53323108 0.53510128 0.53696407 0.53882038 0.54066991 0.54251541 
    ##      PC175      PC176      PC177      PC178      PC179      PC180 
    ## 0.54435314 0.54618366 0.54800664 0.54982613 0.55163584 0.55344037 
    ##      PC181      PC182      PC183      PC184      PC185      PC186 
    ## 0.55523885 0.55703401 0.55882567 0.56061254 0.56238706 0.56415952 
    ##      PC187      PC188      PC189      PC190      PC191      PC192 
    ## 0.56592556 0.56768851 0.56944397 0.57119110 0.57293359 0.57467147 
    ##      PC193      PC194      PC195      PC196      PC197      PC198 
    ## 0.57640395 0.57813160 0.57985087 0.58156465 0.58327124 0.58497469 
    ##      PC199      PC200      PC201      PC202      PC203      PC204 
    ## 0.58667255 0.58836821 0.59005832 0.59173647 0.59340612 0.59507286 
    ##      PC205      PC206      PC207      PC208      PC209      PC210 
    ## 0.59673886 0.59840138 0.60005302 0.60169979 0.60334220 0.60498008 
    ##      PC211      PC212      PC213      PC214      PC215      PC216 
    ## 0.60661311 0.60824136 0.60986501 0.61147780 0.61308832 0.61469458 
    ##      PC217      PC218      PC219      PC220      PC221      PC222 
    ## 0.61629517 0.61789166 0.61948310 0.62107010 0.62265432 0.62422943 
    ##      PC223      PC224      PC225      PC226      PC227      PC228 
    ## 0.62580352 0.62737367 0.62893912 0.63050059 0.63205864 0.63360670 
    ##      PC229      PC230      PC231      PC232      PC233      PC234 
    ## 0.63514987 0.63669043 0.63822203 0.63974789 0.64126841 0.64278402 
    ##      PC235      PC236      PC237      PC238      PC239      PC240 
    ## 0.64429794 0.64580409 0.64730919 0.64880750 0.65029910 0.65178722 
    ##      PC241      PC242      PC243      PC244      PC245      PC246 
    ## 0.65327219 0.65475218 0.65622701 0.65769471 0.65915893 0.66062081 
    ##      PC247      PC248      PC249      PC250      PC251      PC252 
    ## 0.66207646 0.66352779 0.66496997 0.66640932 0.66784721 0.66927858 
    ##      PC253      PC254      PC255      PC256      PC257      PC258 
    ## 0.67070678 0.67212462 0.67353987 0.67494889 0.67635308 0.67775475 
    ##      PC259      PC260      PC261      PC262      PC263      PC264 
    ## 0.67915413 0.68055183 0.68194856 0.68333602 0.68472088 0.68610244 
    ##      PC265      PC266      PC267      PC268      PC269      PC270 
    ## 0.68748323 0.68885564 0.69022074 0.69158242 0.69293969 0.69429279 
    ##      PC271      PC272      PC273      PC274      PC275      PC276 
    ## 0.69564516 0.69699192 0.69833524 0.69967632 0.70100982 0.70233976 
    ##      PC277      PC278      PC279      PC280      PC281      PC282 
    ## 0.70366437 0.70497943 0.70629226 0.70759776 0.70889914 0.71019537 
    ##      PC283      PC284      PC285      PC286      PC287      PC288 
    ## 0.71148928 0.71278120 0.71407191 0.71535891 0.71664011 0.71791500 
    ##      PC289      PC290      PC291      PC292      PC293      PC294 
    ## 0.71918783 0.72045599 0.72172097 0.72298305 0.72424191 0.72549534 
    ##      PC295      PC296      PC297      PC298      PC299      PC300 
    ## 0.72674606 0.72798723 0.72922786 0.73046281 0.73169596 0.73292345 
    ##      PC301      PC302      PC303      PC304      PC305      PC306 
    ## 0.73414940 0.73537275 0.73659141 0.73780364 0.73901410 0.74021953 
    ##      PC307      PC308      PC309      PC310      PC311      PC312 
    ## 0.74142370 0.74262569 0.74382015 0.74501279 0.74620124 0.74738157 
    ##      PC313      PC314      PC315      PC316      PC317      PC318 
    ## 0.74855984 0.74973200 0.75090147 0.75206964 0.75323397 0.75439643 
    ##      PC319      PC320      PC321      PC322      PC323      PC324 
    ## 0.75555420 0.75670603 0.75785449 0.75900188 0.76014413 0.76128122 
    ##      PC325      PC326      PC327      PC328      PC329      PC330 
    ## 0.76241353 0.76354230 0.76466902 0.76579230 0.76691302 0.76803149 
    ##      PC331      PC332      PC333      PC334      PC335      PC336 
    ## 0.76914523 0.77025425 0.77136070 0.77246209 0.77356133 0.77465732 
    ##      PC337      PC338      PC339      PC340      PC341      PC342 
    ## 0.77574891 0.77683722 0.77792229 0.77900256 0.78008056 0.78115413 
    ##      PC343      PC344      PC345      PC346      PC347      PC348 
    ## 0.78222631 0.78329769 0.78436338 0.78542620 0.78648583 0.78754131 
    ##      PC349      PC350      PC351      PC352      PC353      PC354 
    ## 0.78859176 0.78963979 0.79068424 0.79172456 0.79276404 0.79379863 
    ##      PC355      PC356      PC357      PC358      PC359      PC360 
    ## 0.79482885 0.79585749 0.79688397 0.79790616 0.79892562 0.79993986 
    ##      PC361      PC362      PC363      PC364      PC365      PC366 
    ## 0.80095040 0.80195826 0.80296299 0.80396488 0.80496193 0.80595676 
    ##      PC367      PC368      PC369      PC370      PC371      PC372 
    ## 0.80694810 0.80793793 0.80892372 0.80990852 0.81088739 0.81186088 
    ##      PC373      PC374      PC375      PC376      PC377      PC378 
    ## 0.81283050 0.81379948 0.81476541 0.81572729 0.81668810 0.81764415 
    ##      PC379      PC380      PC381      PC382      PC383      PC384 
    ## 0.81859650 0.81954767 0.82049542 0.82143832 0.82237861 0.82331241 
    ##      PC385      PC386      PC387      PC388      PC389      PC390 
    ## 0.82424559 0.82517445 0.82610060 0.82702591 0.82794611 0.82886406 
    ##      PC391      PC392      PC393      PC394      PC395      PC396 
    ## 0.82977947 0.83069132 0.83160029 0.83250717 0.83341092 0.83431286 
    ##      PC397      PC398      PC399      PC400      PC401      PC402 
    ## 0.83521199 0.83611083 0.83700479 0.83789293 0.83877799 0.83965884 
    ##      PC403      PC404      PC405      PC406      PC407      PC408 
    ## 0.84053722 0.84141369 0.84228904 0.84316200 0.84403202 0.84489688 
    ##      PC409      PC410      PC411      PC412      PC413      PC414 
    ## 0.84575921 0.84662002 0.84747917 0.84833236 0.84918358 0.85003247 
    ##      PC415      PC416      PC417      PC418      PC419      PC420 
    ## 0.85088108 0.85172482 0.85256759 0.85340827 0.85424683 0.85507896 
    ##      PC421      PC422      PC423      PC424      PC425      PC426 
    ## 0.85590882 0.85673600 0.85755631 0.85837600 0.85919084 0.86000410 
    ##      PC427      PC428      PC429      PC430      PC431      PC432 
    ## 0.86081362 0.86162061 0.86242590 0.86322751 0.86402398 0.86481761 
    ##      PC433      PC434      PC435      PC436      PC437      PC438 
    ## 0.86560930 0.86640052 0.86718728 0.86797295 0.86875635 0.86953592 
    ##      PC439      PC440      PC441      PC442      PC443      PC444 
    ## 0.87031538 0.87109224 0.87186599 0.87263743 0.87340648 0.87417276 
    ##      PC445      PC446      PC447      PC448      PC449      PC450 
    ## 0.87493593 0.87569864 0.87645849 0.87721437 0.87796530 0.87871306 
    ##      PC451      PC452      PC453      PC454      PC455      PC456 
    ## 0.87946019 0.88020507 0.88094589 0.88168485 0.88242020 0.88315421 
    ##      PC457      PC458      PC459      PC460      PC461      PC462 
    ## 0.88388777 0.88461685 0.88534575 0.88607192 0.88679487 0.88751408 
    ##      PC463      PC464      PC465      PC466      PC467      PC468 
    ## 0.88823052 0.88894498 0.88965602 0.89036567 0.89107257 0.89177616 
    ##      PC469      PC470      PC471      PC472      PC473      PC474 
    ## 0.89247750 0.89317626 0.89387376 0.89456774 0.89526019 0.89594705 
    ##      PC475      PC476      PC477      PC478      PC479      PC480 
    ## 0.89663148 0.89731367 0.89799256 0.89866745 0.89934183 0.90001427 
    ##      PC481      PC482      PC483      PC484      PC485      PC486 
    ## 0.90068350 0.90134871 0.90201337 0.90267547 0.90333544 0.90399331 
    ##      PC487      PC488      PC489      PC490      PC491      PC492 
    ## 0.90464838 0.90530119 0.90595332 0.90660287 0.90724858 0.90789197 
    ##      PC493      PC494      PC495      PC496      PC497      PC498 
    ## 0.90853378 0.90917513 0.90981277 0.91044669 0.91107849 0.91170864 
    ##      PC499      PC500      PC501      PC502      PC503      PC504 
    ## 0.91233704 0.91296121 0.91358441 0.91420424 0.91482195 0.91543689 
    ##      PC505      PC506      PC507      PC508      PC509      PC510 
    ## 0.91605120 0.91666382 0.91727229 0.91787690 0.91847928 0.91908050 
    ##      PC511      PC512      PC513      PC514      PC515      PC516 
    ## 0.91967837 0.92027609 0.92087160 0.92146419 0.92205280 0.92264043 
    ##      PC517      PC518      PC519      PC520      PC521      PC522 
    ## 0.92322544 0.92380901 0.92439067 0.92496959 0.92554684 0.92612216 
    ##      PC523      PC524      PC525      PC526      PC527      PC528 
    ## 0.92669592 0.92726671 0.92783577 0.92840219 0.92896619 0.92952821 
    ##      PC529      PC530      PC531      PC532      PC533      PC534 
    ## 0.93008611 0.93064104 0.93119388 0.93174485 0.93229420 0.93283931 
    ##      PC535      PC536      PC537      PC538      PC539      PC540 
    ## 0.93338413 0.93392588 0.93446653 0.93500386 0.93554067 0.93607397 
    ##      PC541      PC542      PC543      PC544      PC545      PC546 
    ## 0.93660580 0.93713568 0.93766328 0.93818605 0.93870613 0.93922530 
    ##      PC547      PC548      PC549      PC550      PC551      PC552 
    ## 0.93974303 0.94025838 0.94077283 0.94128670 0.94179712 0.94230471 
    ##      PC553      PC554      PC555      PC556      PC557      PC558 
    ## 0.94281037 0.94331332 0.94381361 0.94431331 0.94481217 0.94530828 
    ##      PC559      PC560      PC561      PC562      PC563      PC564 
    ## 0.94580076 0.94629223 0.94678235 0.94727044 0.94775562 0.94823976 
    ##      PC565      PC566      PC567      PC568      PC569      PC570 
    ## 0.94872172 0.94920145 0.94967825 0.95015465 0.95062655 0.95109637 
    ##      PC571      PC572      PC573      PC574      PC575      PC576 
    ## 0.95156486 0.95203159 0.95249740 0.95296029 0.95342218 0.95388094 
    ##      PC577      PC578      PC579      PC580      PC581      PC582 
    ## 0.95433574 0.95478905 0.95523997 0.95568933 0.95613726 0.95658398 
    ##      PC583      PC584      PC585      PC586      PC587      PC588 
    ## 0.95702715 0.95747013 0.95790898 0.95834596 0.95878090 0.95921430 
    ##      PC589      PC590      PC591      PC592      PC593      PC594 
    ## 0.95964697 0.96007681 0.96050491 0.96093060 0.96135496 0.96177794 
    ##      PC595      PC596      PC597      PC598      PC599      PC600 
    ## 0.96219858 0.96261701 0.96303448 0.96344970 0.96386314 0.96427574 
    ##      PC601      PC602      PC603      PC604      PC605      PC606 
    ## 0.96468478 0.96509274 0.96549949 0.96590581 0.96630790 0.96670730 
    ##      PC607      PC608      PC609      PC610      PC611      PC612 
    ## 0.96710294 0.96749789 0.96788968 0.96827770 0.96866538 0.96905067 
    ##      PC613      PC614      PC615      PC616      PC617      PC618 
    ## 0.96943272 0.96981348 0.97019194 0.97056962 0.97094388 0.97131745 
    ##      PC619      PC620      PC621      PC622      PC623      PC624 
    ## 0.97168883 0.97205928 0.97242674 0.97279292 0.97315656 0.97351806 
    ##      PC625      PC626      PC627      PC628      PC629      PC630 
    ## 0.97387880 0.97423751 0.97459217 0.97494569 0.97529877 0.97564910 
    ##      PC631      PC632      PC633      PC634      PC635      PC636 
    ## 0.97599886 0.97634449 0.97668904 0.97703027 0.97737062 0.97770857 
    ##      PC637      PC638      PC639      PC640      PC641      PC642 
    ## 0.97804559 0.97838046 0.97871497 0.97904819 0.97937879 0.97970830 
    ##      PC643      PC644      PC645      PC646      PC647      PC648 
    ## 0.98003509 0.98036177 0.98068410 0.98100604 0.98132566 0.98164268 
    ##      PC649      PC650      PC651      PC652      PC653      PC654 
    ## 0.98195737 0.98226959 0.98258014 0.98289036 0.98319823 0.98350312 
    ##      PC655      PC656      PC657      PC658      PC659      PC660 
    ## 0.98380642 0.98410797 0.98440816 0.98470689 0.98500392 0.98529878 
    ##      PC661      PC662      PC663      PC664      PC665      PC666 
    ## 0.98559224 0.98588403 0.98617386 0.98646202 0.98674854 0.98703314 
    ##      PC667      PC668      PC669      PC670      PC671      PC672 
    ## 0.98731514 0.98759618 0.98787581 0.98815369 0.98842899 0.98870286 
    ##      PC673      PC674      PC675      PC676      PC677      PC678 
    ## 0.98897474 0.98924367 0.98951079 0.98977567 0.99003962 0.99030130 
    ##      PC679      PC680      PC681      PC682      PC683      PC684 
    ## 0.99056276 0.99082247 0.99107739 0.99133192 0.99158390 0.99183330 
    ##      PC685      PC686      PC687      PC688      PC689      PC690 
    ## 0.99208162 0.99232902 0.99257421 0.99281884 0.99306077 0.99330102 
    ##      PC691      PC692      PC693      PC694      PC695      PC696 
    ## 0.99353674 0.99377054 0.99400261 0.99423224 0.99445915 0.99468511 
    ##      PC697      PC698      PC699      PC700      PC701      PC702 
    ## 0.99490797 0.99512892 0.99534923 0.99556635 0.99578029 0.99599198 
    ##      PC703      PC704      PC705      PC706      PC707      PC708 
    ## 0.99620025 0.99640809 0.99661192 0.99681442 0.99701556 0.99721500 
    ##      PC709      PC710      PC711      PC712      PC713      PC714 
    ## 0.99741155 0.99760589 0.99779868 0.99798770 0.99817524 0.99835790 
    ##      PC715      PC716      PC717      PC718      PC719      PC720 
    ## 0.99853949 0.99871925 0.99889344 0.99906414 0.99923129 0.99939786 
    ##      PC721      PC722      PC723      PC724      PC725      PC726 
    ## 0.99955815 0.99971116 0.99985273 0.99996341 0.99999525 1.00000000

``` r
plot(pca_train2,type='line')
```

![](tf_idf_md_files/figure-markdown_github/unnamed-chunk-13-1.png)

``` r
#summary(pca_train2)

vars2 <- apply(pca_train2$x, 2, var)  
props2 <- vars2 / sum(vars2)
cumsum(props2)
```

    ##        PC1        PC2        PC3        PC4        PC5        PC6 
    ## 0.01843312 0.03065004 0.04016893 0.04946977 0.05787282 0.06593379 
    ##        PC7        PC8        PC9       PC10       PC11       PC12 
    ## 0.07291848 0.07975369 0.08618059 0.09236053 0.09823468 0.10397261 
    ##       PC13       PC14       PC15       PC16       PC17       PC18 
    ## 0.10932185 0.11444593 0.11936364 0.12390007 0.12839142 0.13281126 
    ##       PC19       PC20       PC21       PC22       PC23       PC24 
    ## 0.13714234 0.14144219 0.14561005 0.14970256 0.15377876 0.15782817 
    ##       PC25       PC26       PC27       PC28       PC29       PC30 
    ## 0.16179933 0.16566349 0.16944750 0.17321285 0.17687553 0.18051731 
    ##       PC31       PC32       PC33       PC34       PC35       PC36 
    ## 0.18411494 0.18763664 0.19112231 0.19455639 0.19797032 0.20133096 
    ##       PC37       PC38       PC39       PC40       PC41       PC42 
    ## 0.20466697 0.20798341 0.21127382 0.21452295 0.21774874 0.22095984 
    ##       PC43       PC44       PC45       PC46       PC47       PC48 
    ## 0.22416543 0.22731488 0.23046246 0.23357444 0.23664572 0.23969780 
    ##       PC49       PC50       PC51       PC52       PC53       PC54 
    ## 0.24271440 0.24570988 0.24869735 0.25165753 0.25460952 0.25756083 
    ##       PC55       PC56       PC57       PC58       PC59       PC60 
    ## 0.26048855 0.26339466 0.26627320 0.26914123 0.27198575 0.27481761 
    ##       PC61       PC62       PC63       PC64       PC65       PC66 
    ## 0.27762068 0.28042006 0.28320820 0.28597761 0.28874240 0.29149424 
    ##       PC67       PC68       PC69       PC70       PC71       PC72 
    ## 0.29423323 0.29695383 0.29965105 0.30233132 0.30499974 0.30765182 
    ##       PC73       PC74       PC75       PC76       PC77       PC78 
    ## 0.31029714 0.31293190 0.31554859 0.31815870 0.32075343 0.32332946 
    ##       PC79       PC80       PC81       PC82       PC83       PC84 
    ## 0.32589043 0.32843069 0.33096607 0.33349568 0.33601646 0.33852637 
    ##       PC85       PC86       PC87       PC88       PC89       PC90 
    ## 0.34102725 0.34351410 0.34598742 0.34845656 0.35091815 0.35336701 
    ##       PC91       PC92       PC93       PC94       PC95       PC96 
    ## 0.35579699 0.35821341 0.36061069 0.36300445 0.36539099 0.36776045 
    ##       PC97       PC98       PC99      PC100      PC101      PC102 
    ## 0.37011708 0.37246459 0.37480874 0.37714083 0.37946807 0.38178733 
    ##      PC103      PC104      PC105      PC106      PC107      PC108 
    ## 0.38409624 0.38640233 0.38869584 0.39098046 0.39325653 0.39550684 
    ##      PC109      PC110      PC111      PC112      PC113      PC114 
    ## 0.39775140 0.39998823 0.40222151 0.40445244 0.40667498 0.40889123 
    ##      PC115      PC116      PC117      PC118      PC119      PC120 
    ## 0.41109824 0.41330107 0.41549220 0.41767181 0.41984161 0.42200864 
    ##      PC121      PC122      PC123      PC124      PC125      PC126 
    ## 0.42416469 0.42631180 0.42844984 0.43058104 0.43270598 0.43482901 
    ##      PC127      PC128      PC129      PC130      PC131      PC132 
    ## 0.43693997 0.43904810 0.44114353 0.44322649 0.44530786 0.44737198 
    ##      PC133      PC134      PC135      PC136      PC137      PC138 
    ## 0.44943135 0.45148552 0.45353456 0.45557771 0.45761400 0.45963691 
    ##      PC139      PC140      PC141      PC142      PC143      PC144 
    ## 0.46165573 0.46367037 0.46567978 0.46768476 0.46968812 0.47167859 
    ##      PC145      PC146      PC147      PC148      PC149      PC150 
    ## 0.47365520 0.47562534 0.47759082 0.47954408 0.48149326 0.48343780 
    ##      PC151      PC152      PC153      PC154      PC155      PC156 
    ## 0.48537757 0.48731441 0.48923196 0.49114585 0.49305719 0.49496342 
    ##      PC157      PC158      PC159      PC160      PC161      PC162 
    ## 0.49686519 0.49875652 0.50063846 0.50251201 0.50438336 0.50624986 
    ##      PC163      PC164      PC165      PC166      PC167      PC168 
    ## 0.50811041 0.50996569 0.51181393 0.51365723 0.51549487 0.51732858 
    ##      PC169      PC170      PC171      PC172      PC173      PC174 
    ## 0.51915371 0.52097726 0.52279169 0.52459815 0.52639675 0.52818793 
    ##      PC175      PC176      PC177      PC178      PC179      PC180 
    ## 0.52997115 0.53175131 0.53352536 0.53529823 0.53706239 0.53882081 
    ##      PC181      PC182      PC183      PC184      PC185      PC186 
    ## 0.54057745 0.54232474 0.54406116 0.54579623 0.54752467 0.54924566 
    ##      PC187      PC188      PC189      PC190      PC191      PC192 
    ## 0.55096287 0.55267730 0.55438625 0.55609219 0.55778711 0.55947960 
    ##      PC193      PC194      PC195      PC196      PC197      PC198 
    ## 0.56116357 0.56284306 0.56452003 0.56619373 0.56786262 0.56952253 
    ##      PC199      PC200      PC201      PC202      PC203      PC204 
    ## 0.57117744 0.57282602 0.57446676 0.57610431 0.57773856 0.57937132 
    ##      PC205      PC206      PC207      PC208      PC209      PC210 
    ## 0.58099549 0.58261309 0.58422702 0.58583492 0.58744026 0.58904146 
    ##      PC211      PC212      PC213      PC214      PC215      PC216 
    ## 0.59063776 0.59223108 0.59381449 0.59539450 0.59696821 0.59853897 
    ##      PC217      PC218      PC219      PC220      PC221      PC222 
    ## 0.60010597 0.60166469 0.60322013 0.60477071 0.60631535 0.60785747 
    ##      PC223      PC224      PC225      PC226      PC227      PC228 
    ## 0.60939264 0.61092527 0.61245260 0.61397757 0.61549456 0.61700331 
    ##      PC229      PC230      PC231      PC232      PC233      PC234 
    ## 0.61851068 0.62001312 0.62150970 0.62299760 0.62447912 0.62595770 
    ##      PC235      PC236      PC237      PC238      PC239      PC240 
    ## 0.62743120 0.62890128 0.63036625 0.63182553 0.63328269 0.63473468 
    ##      PC241      PC242      PC243      PC244      PC245      PC246 
    ## 0.63618245 0.63762344 0.63905785 0.64048853 0.64191623 0.64334254 
    ##      PC247      PC248      PC249      PC250      PC251      PC252 
    ## 0.64476187 0.64617960 0.64759308 0.64900616 0.65041338 0.65181458 
    ##      PC253      PC254      PC255      PC256      PC257      PC258 
    ## 0.65320765 0.65459786 0.65598426 0.65736821 0.65875041 0.66012533 
    ##      PC259      PC260      PC261      PC262      PC263      PC264 
    ## 0.66149800 0.66286976 0.66423505 0.66559804 0.66695503 0.66830748 
    ##      PC265      PC266      PC267      PC268      PC269      PC270 
    ## 0.66965716 0.67100170 0.67233905 0.67367371 0.67500705 0.67633867 
    ##      PC271      PC272      PC273      PC274      PC275      PC276 
    ## 0.67766319 0.67898178 0.68029678 0.68161046 0.68292023 0.68422427 
    ##      PC277      PC278      PC279      PC280      PC281      PC282 
    ## 0.68552570 0.68682453 0.68812070 0.68941161 0.69069742 0.69197854 
    ##      PC283      PC284      PC285      PC286      PC287      PC288 
    ## 0.69325673 0.69453057 0.69580132 0.69706914 0.69833218 0.69958970 
    ##      PC289      PC290      PC291      PC292      PC293      PC294 
    ## 0.70084244 0.70209020 0.70333552 0.70457735 0.70581282 0.70704559 
    ##      PC295      PC296      PC297      PC298      PC299      PC300 
    ## 0.70826928 0.70949029 0.71071088 0.71192754 0.71314283 0.71435624 
    ##      PC301      PC302      PC303      PC304      PC305      PC306 
    ## 0.71556417 0.71676631 0.71796467 0.71915902 0.72034914 0.72153588 
    ##      PC307      PC308      PC309      PC310      PC311      PC312 
    ## 0.72271850 0.72389834 0.72507574 0.72624970 0.72742150 0.72858794 
    ##      PC313      PC314      PC315      PC316      PC317      PC318 
    ## 0.72975215 0.73091323 0.73206802 0.73321880 0.73436756 0.73551435 
    ##      PC319      PC320      PC321      PC322      PC323      PC324 
    ## 0.73665774 0.73779601 0.73893204 0.74006257 0.74118883 0.74231264 
    ##      PC325      PC326      PC327      PC328      PC329      PC330 
    ## 0.74343402 0.74455384 0.74566836 0.74677877 0.74788647 0.74899117 
    ##      PC331      PC332      PC333      PC334      PC335      PC336 
    ## 0.75009092 0.75118859 0.75228267 0.75337214 0.75446071 0.75554621 
    ##      PC337      PC338      PC339      PC340      PC341      PC342 
    ## 0.75662741 0.75770672 0.75878172 0.75985199 0.76091886 0.76198465 
    ##      PC343      PC344      PC345      PC346      PC347      PC348 
    ## 0.76304551 0.76410190 0.76515742 0.76620728 0.76725472 0.76830150 
    ##      PC349      PC350      PC351      PC352      PC353      PC354 
    ## 0.76934287 0.77038141 0.77141741 0.77245320 0.77348460 0.77451522 
    ##      PC355      PC356      PC357      PC358      PC359      PC360 
    ## 0.77554384 0.77656951 0.77759319 0.77861366 0.77962813 0.78063864 
    ##      PC361      PC362      PC363      PC364      PC365      PC366 
    ## 0.78164572 0.78264862 0.78364783 0.78464151 0.78563222 0.78661995 
    ##      PC367      PC368      PC369      PC370      PC371      PC372 
    ## 0.78760470 0.78858882 0.78956630 0.79054304 0.79151599 0.79248768 
    ##      PC373      PC374      PC375      PC376      PC377      PC378 
    ## 0.79345253 0.79441506 0.79537575 0.79633393 0.79728947 0.79824062 
    ##      PC379      PC380      PC381      PC382      PC383      PC384 
    ## 0.79918875 0.80013380 0.80107407 0.80201298 0.80294995 0.80388414 
    ##      PC385      PC386      PC387      PC388      PC389      PC390 
    ## 0.80481476 0.80574079 0.80666478 0.80758724 0.80850659 0.80942329 
    ##      PC391      PC392      PC393      PC394      PC395      PC396 
    ## 0.81033983 0.81124773 0.81215464 0.81305973 0.81396053 0.81485680 
    ##      PC397      PC398      PC399      PC400      PC401      PC402 
    ## 0.81575036 0.81664317 0.81753331 0.81841902 0.81930411 0.82018705 
    ##      PC403      PC404      PC405      PC406      PC407      PC408 
    ## 0.82106705 0.82194520 0.82282031 0.82369315 0.82456361 0.82543103 
    ##      PC409      PC410      PC411      PC412      PC413      PC414 
    ## 0.82629678 0.82715915 0.82801933 0.82887776 0.82973459 0.83058622 
    ##      PC415      PC416      PC417      PC418      PC419      PC420 
    ## 0.83143208 0.83227734 0.83311912 0.83396036 0.83479985 0.83563371 
    ##      PC421      PC422      PC423      PC424      PC425      PC426 
    ## 0.83646649 0.83729757 0.83812529 0.83894962 0.83977023 0.84058696 
    ##      PC427      PC428      PC429      PC430      PC431      PC432 
    ## 0.84139944 0.84221038 0.84301985 0.84382901 0.84463565 0.84543843 
    ##      PC433      PC434      PC435      PC436      PC437      PC438 
    ## 0.84623907 0.84703793 0.84783528 0.84862984 0.84942193 0.85020958 
    ##      PC439      PC440      PC441      PC442      PC443      PC444 
    ## 0.85099450 0.85177818 0.85255807 0.85333385 0.85410770 0.85487766 
    ##      PC445      PC446      PC447      PC448      PC449      PC450 
    ## 0.85564353 0.85640902 0.85717329 0.85793481 0.85869337 0.85945133 
    ##      PC451      PC452      PC453      PC454      PC455      PC456 
    ## 0.86020348 0.86095153 0.86169889 0.86244556 0.86318994 0.86393171 
    ##      PC457      PC458      PC459      PC460      PC461      PC462 
    ## 0.86467097 0.86540705 0.86613950 0.86686913 0.86759800 0.86832459 
    ##      PC463      PC464      PC465      PC466      PC467      PC468 
    ## 0.86904917 0.86976856 0.87048774 0.87120601 0.87192387 0.87263694 
    ##      PC469      PC470      PC471      PC472      PC473      PC474 
    ## 0.87334856 0.87405808 0.87476433 0.87546852 0.87617186 0.87687276 
    ##      PC475      PC476      PC477      PC478      PC479      PC480 
    ## 0.87757039 0.87826366 0.87895640 0.87964758 0.88033762 0.88102413 
    ##      PC481      PC482      PC483      PC484      PC485      PC486 
    ## 0.88170852 0.88239194 0.88307353 0.88375392 0.88443129 0.88510282 
    ##      PC487      PC488      PC489      PC490      PC491      PC492 
    ## 0.88577302 0.88644182 0.88710742 0.88777123 0.88843357 0.88909290 
    ##      PC493      PC494      PC495      PC496      PC497      PC498 
    ## 0.88975040 0.89040707 0.89105909 0.89171009 0.89235758 0.89300273 
    ##      PC499      PC500      PC501      PC502      PC503      PC504 
    ## 0.89364635 0.89428825 0.89492779 0.89556602 0.89620254 0.89683460 
    ##      PC505      PC506      PC507      PC508      PC509      PC510 
    ## 0.89746470 0.89809155 0.89871696 0.89934089 0.89996323 0.90058340 
    ##      PC511      PC512      PC513      PC514      PC515      PC516 
    ## 0.90120194 0.90181612 0.90242716 0.90303705 0.90364443 0.90425007 
    ##      PC517      PC518      PC519      PC520      PC521      PC522 
    ## 0.90485428 0.90545684 0.90605777 0.90665586 0.90725314 0.90784856 
    ##      PC523      PC524      PC525      PC526      PC527      PC528 
    ## 0.90844286 0.90903434 0.90962307 0.91020980 0.91079390 0.91137421 
    ##      PC529      PC530      PC531      PC532      PC533      PC534 
    ## 0.91195339 0.91252908 0.91310361 0.91367687 0.91424734 0.91481510 
    ##      PC535      PC536      PC537      PC538      PC539      PC540 
    ## 0.91538132 0.91594583 0.91650737 0.91706691 0.91762604 0.91818222 
    ##      PC541      PC542      PC543      PC544      PC545      PC546 
    ## 0.91873464 0.91928644 0.91983539 0.92038068 0.92092504 0.92146783 
    ##      PC547      PC548      PC549      PC550      PC551      PC552 
    ## 0.92200766 0.92254604 0.92308398 0.92362006 0.92415535 0.92468524 
    ##      PC553      PC554      PC555      PC556      PC557      PC558 
    ## 0.92521424 0.92574238 0.92626837 0.92679184 0.92731291 0.92783102 
    ##      PC559      PC560      PC561      PC562      PC563      PC564 
    ## 0.92834642 0.92886076 0.92937370 0.92988510 0.93039527 0.93090434 
    ##      PC565      PC566      PC567      PC568      PC569      PC570 
    ## 0.93141044 0.93191327 0.93241369 0.93291361 0.93341067 0.93390545 
    ##      PC571      PC572      PC573      PC574      PC575      PC576 
    ## 0.93439825 0.93489012 0.93537817 0.93586523 0.93635067 0.93683469 
    ##      PC577      PC578      PC579      PC580      PC581      PC582 
    ## 0.93731709 0.93779513 0.93827226 0.93874773 0.93922216 0.93969225 
    ##      PC583      PC584      PC585      PC586      PC587      PC588 
    ## 0.94016131 0.94062985 0.94109776 0.94156417 0.94202692 0.94248751 
    ##      PC589      PC590      PC591      PC592      PC593      PC594 
    ## 0.94294679 0.94340535 0.94386311 0.94431653 0.94476897 0.94522094 
    ##      PC595      PC596      PC597      PC598      PC599      PC600 
    ## 0.94566970 0.94611684 0.94656101 0.94700312 0.94744348 0.94788256 
    ##      PC601      PC602      PC603      PC604      PC605      PC606 
    ## 0.94831817 0.94875314 0.94918701 0.94961846 0.95004827 0.95047425 
    ##      PC607      PC608      PC609      PC610      PC611      PC612 
    ## 0.95089852 0.95132085 0.95174250 0.95216186 0.95258055 0.95299695 
    ##      PC613      PC614      PC615      PC616      PC617      PC618 
    ## 0.95341222 0.95382500 0.95423624 0.95464690 0.95505656 0.95546293 
    ##      PC619      PC620      PC621      PC622      PC623      PC624 
    ## 0.95586745 0.95627072 0.95667319 0.95707499 0.95747526 0.95787432 
    ##      PC625      PC626      PC627      PC628      PC629      PC630 
    ## 0.95826939 0.95866301 0.95905460 0.95944351 0.95983055 0.96021692 
    ##      PC631      PC632      PC633      PC634      PC635      PC636 
    ## 0.96060097 0.96098347 0.96136500 0.96174378 0.96212237 0.96249961 
    ##      PC637      PC638      PC639      PC640      PC641      PC642 
    ## 0.96287473 0.96324723 0.96361922 0.96398990 0.96435781 0.96472563 
    ##      PC643      PC644      PC645      PC646      PC647      PC648 
    ## 0.96509071 0.96545485 0.96581720 0.96617883 0.96653739 0.96689442 
    ##      PC649      PC650      PC651      PC652      PC653      PC654 
    ## 0.96724694 0.96759790 0.96794634 0.96829353 0.96863987 0.96898589 
    ##      PC655      PC656      PC657      PC658      PC659      PC660 
    ## 0.96933097 0.96967474 0.97001509 0.97035393 0.97069136 0.97102672 
    ##      PC661      PC662      PC663      PC664      PC665      PC666 
    ## 0.97136037 0.97169188 0.97202152 0.97235004 0.97267813 0.97300455 
    ##      PC667      PC668      PC669      PC670      PC671      PC672 
    ## 0.97332920 0.97365206 0.97397285 0.97429244 0.97461024 0.97492732 
    ##      PC673      PC674      PC675      PC676      PC677      PC678 
    ## 0.97524352 0.97555867 0.97587031 0.97618136 0.97649071 0.97679664 
    ##      PC679      PC680      PC681      PC682      PC683      PC684 
    ## 0.97710117 0.97740388 0.97770585 0.97800348 0.97830022 0.97859604 
    ##      PC685      PC686      PC687      PC688      PC689      PC690 
    ## 0.97889090 0.97918359 0.97947510 0.97976595 0.98005439 0.98034046 
    ##      PC691      PC692      PC693      PC694      PC695      PC696 
    ## 0.98062511 0.98090883 0.98119174 0.98147234 0.98175158 0.98203043 
    ##      PC697      PC698      PC699      PC700      PC701      PC702 
    ## 0.98230719 0.98258218 0.98285576 0.98312836 0.98339770 0.98366615 
    ##      PC703      PC704      PC705      PC706      PC707      PC708 
    ## 0.98393367 0.98419832 0.98446139 0.98472372 0.98498571 0.98524497 
    ##      PC709      PC710      PC711      PC712      PC713      PC714 
    ## 0.98550285 0.98575959 0.98601419 0.98626771 0.98652051 0.98677078 
    ##      PC715      PC716      PC717      PC718      PC719      PC720 
    ## 0.98701976 0.98726699 0.98751314 0.98775485 0.98799617 0.98823581 
    ##      PC721      PC722      PC723      PC724      PC725      PC726 
    ## 0.98847513 0.98871399 0.98895195 0.98918633 0.98941932 0.98965158 
    ##      PC727      PC728      PC729      PC730      PC731      PC732 
    ## 0.98988255 0.99011136 0.99033986 0.99056583 0.99079032 0.99101229 
    ##      PC733      PC734      PC735      PC736      PC737      PC738 
    ## 0.99123328 0.99145261 0.99167005 0.99188487 0.99209914 0.99231194 
    ##      PC739      PC740      PC741      PC742      PC743      PC744 
    ## 0.99252311 0.99273290 0.99293986 0.99314575 0.99335066 0.99355332 
    ##      PC745      PC746      PC747      PC748      PC749      PC750 
    ## 0.99375551 0.99395653 0.99415558 0.99435387 0.99454853 0.99474272 
    ##      PC751      PC752      PC753      PC754      PC755      PC756 
    ## 0.99493447 0.99512339 0.99531072 0.99549753 0.99568248 0.99586621 
    ##      PC757      PC758      PC759      PC760      PC761      PC762 
    ## 0.99604601 0.99622522 0.99640275 0.99657895 0.99675202 0.99692421 
    ##      PC763      PC764      PC765      PC766      PC767      PC768 
    ## 0.99709548 0.99726527 0.99743273 0.99759817 0.99776187 0.99792510 
    ##      PC769      PC770      PC771      PC772      PC773      PC774 
    ## 0.99808503 0.99824294 0.99839608 0.99854832 0.99869688 0.99884411 
    ##      PC775      PC776      PC777      PC778      PC779      PC780 
    ## 0.99898946 0.99913228 0.99927092 0.99940604 0.99953967 0.99966873 
    ##      PC781      PC782      PC783      PC784      PC785 
    ## 0.99978967 0.99989123 0.99998235 0.99999577 1.00000000

Choosing 60% varability hence taking 207 PCs for first set and 217 PCs for second set

Attaching target variable 'author' to the train and test datsets generated after generating PCs

``` r
df_train = data.frame(pca_train$x[,1:207])
df_train['author']=authors
df_test = data.frame(pca_test[,1:207])
df_test2 = df_test
df_test2['author']=authors_test


df_train_new = data.frame(pca_train2$x[,1:217])
df_train_new['author']=authors
df_test_new = data.frame(pca_test2[,1:217])
df_test_new2 = df_test_new
df_test_new2['author']=authors_test
```

#### Naive Bayes for intersected train-test

``` r
library('e1071')

nb_model =naiveBayes(as.factor(author) ~., data=df_train)
nb_predictions_test = predict(nb_model,df_test)
#table(nb_predictions_test,df_test$author)
cm <- caret::confusionMatrix(nb_predictions_test,as.factor(df_test2$author))
accuracy <- cm$overall['Accuracy']
accuracy
```

    ## Accuracy 
    ##   0.4512

``` r
#nb_predictions_test
#45%
```

#### Random Forest for intersected train-test

``` r
library('randomForest')
```

    ## randomForest 4.6-14

    ## Type rfNews() to see new features/changes/bug fixes.

``` r
rf_model = randomForest(as.factor(author) ~ ., data=df_train, ntree=100, mtry=15, importance=TRUE)
rf_predictions_test = predict(rf_model,df_test)
#table(rf_predictions_test,df_test2$author)
cm <- caret::confusionMatrix(rf_predictions_test,as.factor(df_test2$author))
accuracy <- cm$overall['Accuracy']
accuracy
#45%
```

#### Naive Bayes for psuedo word handled train-test

``` r
nb_model_new = naiveBayes(as.factor(author) ~., data=df_train_new)
nb_predictions_test_new = predict(nb_model_new,df_test_new)
#table(nb_predictions_test,df_test$author)
cm <- caret::confusionMatrix(nb_predictions_test_new,as.factor(df_test_new2$author))
accuracy <- cm$overall['Accuracy']
accuracy
```

    ## Accuracy 
    ##   0.4628

``` r
#nb_predictions_test
#46%
```

#### Random Forest for psuedo word handled train-test

``` r
rf_model_new = randomForest(as.factor(author) ~ ., data=df_train_new, ntree=100, mtry=15, importance=TRUE)
rf_predictions_test_new = predict(rf_model_new,df_test_new)
cm <- caret::confusionMatrix(rf_predictions_test_new,as.factor(df_test_new2$author))
accuracy <- cm$overall['Accuracy']
accuracy
```

    ## Accuracy 
    ##    0.454

``` r
#45% accuracy
```

Hence, we can say that pseudo word handled data with Naive Bayes gives us the best results with 46% accuracy.
